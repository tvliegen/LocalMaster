/ = render 'shared/sidebar'
%iframe{:src => 'http://teknion.fotonotes.com/j_spring_security_logout',:style => "display: none"}
.tek-bar
  .container-fluid
    %p.breadcrumb
      %span.last='Tekcare'
    %button.btn.btn-default.btn-xs.to-submit{class: ('active' if params[:status] == 'to_submit')}
      = link_to "New Claim Requests", "/claimsrequests"
    .claim-filters.btn-group.btn-group-xs
      %button.btn.btn-default.in-progress{class: ('active' if params[:status].nil?)}
        = link_to "In Progress", teknion_claims_path(status: 'inprogress')
        %span.badge
          = @total_count
      %button.btn.btn-default.clairfication{class: ('active' if params[:status] == 'info')}
        = link_to "Information Required", teknion_claims_path(status: 'info')
        %span.badge
          = @info_count
      %button.btn.btn-default.resolved{class: ('active' if params[:status] == 'actioned')}
        = link_to "Actioned", teknion_claims_path(status: 'actioned')
        %span.badge
          = @action_count
      %button.btn.btn-default.closed{class: ('active' if params[:status] == 'closed')}
        = link_to "Closed", teknion_claims_path(status: 'closed')
        %span.badge
          = @close_count
    Search: 
    = text_field_tag 'search'
    %a{:href => "#", :class => [:btn, 'btn-primary'], :id => "search_btn"} Search 
.container-fluid.claims-list.claim-wrapper
  .col-sm-12.main
    %h2.page-header.claim-status=t(params[:status].nil? ? 'inprogress': params[:status])
    %table.table.table-striped.table-hover{id: 'claim_table'}
      %thead
        %tr
          %th 
            = link_to "Claim Number", teknion_claims_path(sort: 'issue', status: @status, order: @sortorder == 'issue' ? @order : 'desc')
            - if @sortorder.eql?'issue'
              - if @order.eql?'asc' 
                %span.glyphicon.glyphicon-triangle-bottom
              - else
                %span.glyphicon.glyphicon-triangle-top
            - else
              %span.glyphicon.glyphicon-minus
          %th 
            = link_to "Title", teknion_claims_path(sort: 'title', status: @status, order: @status, order: @sortorder == 'issue' ? @order : 'desc')
            - if @sortorder.eql?'title'
              - if @order.eql?'asc'
                %span.glyphicon.glyphicon-triangle-bottom
              - else
                %span.glyphicon.glyphicon-triangle-top
            - else
              %span.glyphicon.glyphicon-minus
          %th 
            = link_to "Project", teknion_claims_path(sort: 'project', status: @status, order: @status, order: @sortorder == 'project' ? @order : 'desc')
            - if @sortorder.eql?'project'
              - if @order.eql?'asc'
                %span.glyphicon.glyphicon-triangle-bottom
              - else
                %span.glyphicon.glyphicon-triangle-top
            - else
              %span.glyphicon.glyphicon-minus
          %th 
            = link_to "Created By", teknion_claims_path(sort: 'author', status: @status, order: @status, order: @sortorder == 'author' ? @order : 'desc')
            - if @sortorder.eql?'author'
              - if @order.eql?'asc'
                %span.glyphicon.glyphicon-triangle-bottom
              - else
                %span.glyphicon.glyphicon-triangle-top
            - else
              %span.glyphicon.glyphicon-minus
          %th 
            = link_to "Last Modified", teknion_claims_path(sort: 'modified', status: @status, order: @status, order: @sortorder == 'modified' ? @order : 'desc')
            - if @sortorder.eql?'modified'
              - if @order.eql?'asc'
                %span.glyphicon.glyphicon-triangle-bottom
              - else
                %span.glyphicon.glyphicon-triangle-top
            - else
              %span.glyphicon.glyphicon-minus
          %th 
            = link_to "Status", teknion_claims_path(sort: 'status', status: @status, order: @status, order: @sortorder == 'status' ? @order : 'desc')
            - if @sortorder.eql?'status'
              - if @order.eql?'asc'
                %span.glyphicon.glyphicon-triangle-bottom
              - else
                %span.glyphicon.glyphicon-triangle-top
            - else
              %span.glyphicon.glyphicon-minus
          %th Actions
      %tbody.rowlink{"data-link" => "row"}
        
        - @claims.each do |claim|
          %tr
            %td
              = link_to claim.incident_id, teknion_claim_path(claim.incident_id)
            %td= claim.claim_description
            %td= claim.project_name
            %td= claim.contact_name
            %td= claim.incident_date
            %td= claim.status
            %td
              -#= button_to "Cancel"
              %a{:href => teknion_claim_close_path(claim.incident_id), :class => ['glyphicon','glyphicon-trash'], :alt => 'Delete'}
              %a{:href => teknion_claim_closereq_path(claim.incident_id), :class => ['glyphicon','glyphicon-folder-close'], :alt => 'Request Close'}
:javascript
  $("#claim_table").floatThead({
    scrollingTop: 150,
    useAbsolutePositioning: false, //the default value
  
    scrollContainer: function($table){
        return $table.closest('claim-wrapper');
        }
                   
    });